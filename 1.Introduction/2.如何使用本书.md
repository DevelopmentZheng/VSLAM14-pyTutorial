# 如何使用本书
## 1 组织方式


>理论部分
- 理论部分中，我们将介绍理解算法所必要的数学知识，并且大多数时候以叙述的方式，而不是像数学书那样用“定义——定理——推论”的方式，因为我觉得这样的方式阅读起来更容易一些，尽管有时候显得不那么严谨

>实践部分
- 实践部分主要是编程实现，讨论程序里各部分的含义以及实验结果。在目录里看到的带有“实践”两个字的章节，你就应该（兴致勃勃地）打开电脑，和我们一起愉快地码代码了

我尽量让每一讲都保持统一的结构，但是由于每讲的内容并不相同，有些章节会显得长一些，另一些则短一点。如果我觉得有必要使用多个实践环节，那么一讲中也会有多个“理论部分”和“实践部分”。值得一提的是，我只会把解决问题相关的数学知识放在书里，尽量保持它们足够浅显。我本人是工科生，也坦荡荡地承认某些做法只要经验上够用，没必要非得在数学上追求完备。只要我们知道这些算法能够工作，并且数学家们告诉了我在这什么情况下可能不工作，那我就表示满意，而不追究那些看似完美但实际复杂冗长的证明（当然它们固有自己的价值）。由于 SLAM 牵涉到了太多数学背景，为了防止本书变成数学书，我们把一些细节上的推导和证明留作习题和补充阅读材料，让感兴趣的读者进一步阅读参考文献，更深入地掌握那些细节。

每讲正文之后，我们设计了一些习题。带 * 号的习题是具有一定难度的。我非常建议读者把习题练习一遍，这对你掌握这些知识很有帮助。

全书的内容主要分为两个部分：
1. 第一部分为数学基础篇，我们会以浅显易懂的方式，铺垫与视觉 SLAM 相关的数学知识，包括：
    - 第 2 讲：SLAM 系统概述，介绍一个 SLAM 系统由哪些模块组成，各模块的具体工作是什么。实践部分介绍编程环境的搭建过程以及 IDE 的使用
    - 第 3 讲介绍三维空间运动，你将接触旋转矩阵、四元数、欧拉角的相关知识，并且在 Eigen 当中使用它们
    - 第 4 讲为李群和李代数。如果你现在不懂李代数为何物，也没有关系。你将学习李代数的定义和使用方式，然后通过 Sophus 操作它们。
    - 第五讲介绍针孔相机模型以及图像在计算机中的表达。你将用 OpenCV 来调取
相机的内外参数。
    - 第六讲介绍非线性优化，包括状态估计理论基础、最小二乘问题、梯度下降方
法。你会完成一个使用 Ceres 和 g2o 进行曲线拟合的实验。

这些就是我们所有的数学了，当然还有你以前学过的高等数学和线性代数。我保证它
们看起来都不会很难——当然若你想进一步深入挖掘，我们会提供一些参考资料供
你阅读，那些材料可能会比正文里讲的那些难一点。

1. 第二部分为 SLAM 技术篇。我们会使用第一部分所介绍的理论，讲述视觉 SLAM中各个模块的工作原理。
    - 第七讲为特征点法的视觉里程计。该讲内容比较多，包括特征点的提取与匹配、对极几何约束的计算、PnP 和 ICP 等。在实践中，你将用这些方法去估计两个图像之间的运动。
    - 第八讲为直接法的视觉里程计。你将学习光流和直接法的原理，然后利用 g2o 实现一个简单的 RGB-D 直接法。
    - 第九讲为视觉里程计的实践章，你将搭建一个视觉里程计框架，综合应用先前学过的知识，实现它的基本功能。从中你会碰到一些问题，例如优化的必要性、关键帧的选择等。
    - 第十讲为后端优化，主要为 Bundle Adjustment 的深入讨论，包括基本的 BA以及如何利用稀疏性加速求解过程。你将用 Ceres 和 g2o 分别书写一个 BA 程序。
    - 第十一讲主要讲后端优化中的位姿图。位姿图是表达关键帧之间约束的一种更紧凑的形式。你将用 g2o 和 gtsam 对一个位姿球进行优化。
    - 第十二讲为回环检测，我们主要介绍以词袋方法为主的回环检测。你将使用 dbow3 书写字典训练程序和回环检测程序。
    - 第十三讲为地图构建。我们会讨论如何使用单目进行稠密深度图的估计（以及这是多么不可靠），然后讨论 RGB-D 的稠密地图构建过程。你会书写极线搜索与块匹配的程序，然后在 RGB-D 中遇到点云地图和八叉树地图的构建问题。
    - 第十四讲主要介绍当前的开源 SLAM 项目以及未来的发展方向。相信阅读了前面的知识之后，你会更容易理解它们的原理，实现自己的新想法。

最后，如果你完全看不懂上面在说什么，恭喜你！这本书很适合你！加油！

&emsp;
## 2 代码
本书所有源代码均托管到 github 上：https://github.com/gaoxiang12/slambook

我强烈建议读者下载它们以供随时查看。代码是按章节划分的，比如第 7 讲的内容就会放在 ch7 文件夹中。此外，本书用到的一些小型库会以压缩包的形式放在 3rdparty 文件夹下，省去了你收集它们的时间。对于像 OpenCV 那种大中型库，我会在它们第一次出现时介绍它的安装方法。如果你对代码有任何疑问，请点击 github 上的 issues 按钮，提交一个问题。确实是代码出现问题的话，我会及时修改；如果是你的理解错了，我也会回复你。如果你不会用 git，没有关系，点击右侧带有 download 的按钮下载至本地即可。网上能搜索到很多关于 git 和 github 的使用教程。

&emsp;
## 3 需要具备的前置知识
本书面向对 SLAM 感兴趣的学生和研究人员。为了能够流畅地阅读本书，我们假设你具备了以下知识：
1. 高等数学、线性代数、概率论。 大部分读者应该在大学本科接触过的基本数学知识。你应当明白矩阵和向量是什么，或者做微分和积分是什么意义。对于 SLAM 中用到的专业知识，我们会额外加以介绍。
2. C++ 语言基础。 由于我们采用 C++ 作为编码语言，所以建议读者至少熟悉这门语言的语法。比如，你应该知道类是什么，如何使用 C++ 标准库，模板类如何使用等等。我们避免过多地使用技巧，但有些地方我们不得不如此。此外，我们还使用了一些 C++ 11 标准的内容，但会在用到的地方加以解释。
3. Linux 基础。我们的开发环境是 Linux 而非 Windows，并且只提供 Linux 下的源程序，不会再提供 Windows 下的开发方法介绍。我们认为掌握 Linux 是一个 SLAM研究人员所必须的，请初学者们暂时不要问为什么，把本书的知识学好之后你就会和我有同样的想法。各种程序库在 Linux 下配置都非常便捷，你也会在此过程中体会到 Linux 的便利。如果读者此前从未使用过 Linux，最好找一本 Linux 教材稍加学习（看懂基本知识即可，一般都是那些书的前几章）。我们不要求读者具有高超的 Linux
技术，但希望读者至少知道“打开终端，进入代码目录”是如何操作的。如果你对自己的 Linux 水平不够自信，本讲的习题里有一些 Linux 知识自测题。如果你清楚自测题的答案，那阅读本书代码不会有任何问题。

对 SLAM 感兴趣但不具备上述知识的读者，可能在阅读本书时会感到困难。如果你没有 C++ 的基本知识，可以读一点《C++ Primer Plus》之类的书入个门；如果你缺少相关的数学知识，也可以先补充一些数学教材，不过我认为对大多数大学本科水平的朋友，读懂本书所需的数学背景肯定是足够了。代码方面，你最好花点时间亲自输入一遍，再调节里面的参数，看看效果会发生怎样的改变。这会对学习很有帮助。
本书可以作为 SLAM 相关课程的教材，亦可作为课外自学材料。