&emsp;
# 1 特征点法
回顾第二讲的内容，我们说过视觉 SLAM 主要分为视觉前端和优化后端。前端也称为 `视觉里程计（VO）`。它根据相邻图像的信息，估计出粗略的相机运动，给后端提供较好的初始值。

VO 的实现方法，按是否需要提取特征，分为
- 特征点法的前端
- 不提特征的直接法前端

基于特征点法的前端，长久以来（直到现在）被认为是视觉里程计的主流方法。它运行稳定，对光照、动态物体不敏感，是目前比较成熟的解决方案。

在本讲中，我们将从特征点法入手，学习如何提取、匹配图像特征点，然后估计两帧之间的相机运动和场景结构，从而实现一个基本的两帧间视觉里程计。

&emsp;
## 1.1 特征点
VO 的主要问题是如何根据图像来估计相机运动。

&emsp;
>路标（Landmark）与图像特征（Features）
- 然而，图像本身是一个由亮度和色彩组成的矩阵，如果直接从矩阵层面考虑运动估计，将会非常困难。所以，我们习惯于采用这样一种做法：

    - 首先，从图像中选取比较有代表性的点。这些点在相机视角发生少量变化后会保持不变，所以我们会在各个图像中找到相同的点

    - 然后，在这些点的基础上，讨论相机位姿估计问题，以及这些点的定位问题。

    在经典 SLAM 模型中，把它们称为 `路标`。而在视觉 SLAM 中，路标则是指 `图像特征（Features）`。根据维基百科的定义，图像特征是一组与计算任务相关的信息，计算任务取决于具体的应用 
    - [29]"https://en.wikipedia.org/wiki/Feature_(computer_vision)。

&emsp;
>灰度值矩阵的问题
- 简而言之，特征是图像信息的另一种数字表达形式。一组好的特征对于在指定任务上的最终表现至关重要，所以多年来研究者们花费了大量的精力对特征进行研究。

    数字图像在计算机中以 `灰度值矩阵` 的方式存储，所以最简单的，`单个图像像素` 也是一种“特征”。
    
    但是，在视觉里程计中，我们希望特征点在相机运动之后保持稳定，而灰度值受 `光照、形变、物体材质` 的影响严重，在不同图像之间变化非常大，不够稳定。理想的情况是，当场景和相机视角发生少量改变时，我还能从图像中判断哪些地方是同一个点，因此仅凭灰度值是不够的，我们需要对图像提取特征点。

&emsp;
>特征点
<div align="center">
    <image src="./imgs/7.1-1.png" width = 400>
</div>
&emsp;

特征点是图像里一些特别的地方。以图 7-1 为例。我们可以把图像中的角点、边缘和区块都当成图像中有代表性的地方。
- 我们更容易精确地指出，某两幅图像当中出现了同一个角点
- 同一个边缘则稍微困难一些，因为沿着该边缘前进，图像局部是相似的
- 同一个区块则是最困难的

我们发现，图像中的角点、边缘相比于像素区块而言更加“特别”，它们不同图像之间的辨识度更强。所以，一种直观的提取特征的方式就是在不同图像间辨认角点，确定它们的对应关系。在这种做法中，角点就是所谓的特征。

&emsp;
>人工特征点
- 然而，在大多数应用中，单纯的角点依然不能满足很多我们的需求。例如，从远处看上去是角点的地方，当相机走近之后，可能就不显示为角点了。或者，当我旋转相机时，角点的外观会发生变化，我们也就不容易辨认出那是同一个角点。为此，计算机视觉领域的研究者们在长年的研究中，设计了许多更加稳定的局部图像特征，如著：
    - `SIFT`：[30] Distinctive image features from scale-invariant keypoints
    - `SURF`：[31] Surf: Speeded up robust features
    - `ORB`：[32]Orb: an efficient alternative to sift or
    surf
    - 等等

&emsp;
>人工特征点的性质
- 相比于朴素的角点，这些人工设计的特征点能够拥有如下的性质：
    - 可重复性（Repeatability）：相同的“区域”可以在不同的图像中被找到。
    - 可区别性（Distinctiveness）：不同的“区域”有不同的表达。
    - 高效率（Efficiency）：同一图像中，特征点的数量应远小于像素的数量。
    - 本地性（Locality）：特征仅与一小片图像区域相关。

&emsp;
>特征点的组成
- 特征点由 `关键点（Key-point）` 和 `描述子（Descriptor）` 两部分组成。比方说，当我们谈论 SIFT 特征时，是指“提取 SIFT 关键点，并计算 SIFT 描述子”两件事情。
    - `关键点` 是指该特征点在图像里的位置，有些特征点还具有朝向、大小等信息
    - `描述子` 通常是一个向量，按照某种人为设计的方式，描述了该关键点周围像素的信息。描述子是按照 "外观相似的特征应该有相似的描述子" 的原则设计的。因此，只要两个特征点的描述子在向量空间上的距离相近，就可以认为它们是同样的特征点。

&emsp;
>各种算法的对比
- 历史上，研究者提出过许多图像特征。它们有些很精确，在相机的运动和光照变化下仍具有相似的表达，但相应地需要较大的计算量。

    - `SIFT`：SIFT（尺度不变特征变换，Scale Invariant Feature Transform) 当属最为经典的一种。
    
        它充分考虑了在图像变换过程中出现的 `光照，尺度，旋转等` 变化，但随之而来的是极大的计算量。由于整个 SLAM 过程中，图像特征的提取与匹配仅仅是诸多环节中的一个，到目前（2016 年）为止，普通 PC 的 CPU 还无法实时地计算 SIFT 特征，进行定位与建图。所以在 SLAM 中我们甚少使用这种“奢侈”的图像特征。

    - `FAST`：另一些特征，则考虑适当降低精度和鲁棒性，提升计算的速度。例如 FAST 关键点属于 `计算特别快` 的一种特征点（注意这里“关键点”的用词，说明它没有描述子）。

    - `ORB`：而 ORB（Oriented FAST and Rotated BRIEF）特征则是目前看来非常具有代表性的实时图像特征。它改进了 FAST [33]：Machine learning for high-speed corner detection 检测子不具有方向性的问题，并采用速度极快的二进制描述子 BRIEF [34]：BRIEF: Binary Robust Independent Elementary Features⋆ 使整个图像特征提取的环节大大加速。

    根据作者在论文中的测试，在同一幅图像中同时提取约 1000 个特征点的情况下，ORB 约要花费 15.3ms，SURF 约花费 217.3ms，SIFT 约花费 5228.7ms。

    由此可以看出 ORB 在保持了特征子具有旋转，尺度不变性的同时，速度方面提升明显，对于实时性要求很高的 SLAM 来说是一个很好的选择。

    大部分特征提取都具有较好的并行性，可以通过 GPU 等设备来加速计算。经过 GPU 加速后的 SIFT，就可以满足实时计算要求。但是，引入 GPU 将带来整个 SLAM 成本的提升。由此带来的性能提升，是否足以抵去付出的计算成本，需要系统的设计人员仔细考量。在目前的 SLAM 方案中，ORB 是 `质量与性能之间较好的折中` ，因此我们以 ORB 为代表，介绍提取特征的整个过程。